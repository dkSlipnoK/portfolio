<?php
include ('header.html');
include ('navbar.php');
?>

<body>
    <!-- ======= Hero Section ======= -->
    <div id="hero" class="hero route bg-image" style="background-image: url(assets/img/rhawk.png)">
        <div class="overlay-itro"></div>
        <div class="hero-content display-table">
            <div class="table-cell">
                <div class="container">
                    <h1 class="hero-title mb-4">Stages</h1>
                    <p class="hero-subtitle"><span class="typed" data-typed-items="Mes stages, Mes expériences professionnelles"></span></p>
                </div>
            </div>
        </div>
    </div>
    <section id="first" class="about-mf sect-pt4 route">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="box-shadow-full">
                        <div class="row">
                            <div>
                                <h5 class="title-center title-left">Stage de première année</h5>
                                <div class="table-of-contents">
                                    <h3 class="h3-TOC">Table des matières</h3>
                                    <div class="toc-item"><a href="#remerciement" class="link-TOC">Remerciement.</a></div>
                                    <div class="toc-item"><a href="#introduction" class="link-TOC">Introduction.</a></div>
                                    <div class="toc-item"><a href="#pres" class="link-TOC">Présentation de Groupe 3il ingénieur.</a></div>
                                    <div class="toc-item"><a href="#stage" class="link-TOC">Le stage au sein de cette association.</a></div>
                                    <div class="toc-item"><a href="#obj" class="link-TOC">Objectif et problématique du stage.</a></div>
                                    <div class="toc-item"><a href="#stage2" class="link-TOC">I) Le stage au sein de l’entreprise.</a></div>
                                    <div class="toc-subitem"><a href="#infra" class="link-TOC">A) Structure et organisation du Groupe 3il.</a></div>
                                    <div class="toc-subitem"><a href="#service" class="link-TOC">B) Les services au sein du Groupe 3il.</a></div>
                                    <div class="toc-item"><a href="#mission" class="link-TOC">II) Missions effectuées.</a></div>
                                    <div class="toc-subitem"><a href="#main" class="link-TOC">A) Missions principales.</a></div>
                                    <div class="toc-subitem"><a href="#second" class="link-TOC">B) Missions secondaires.</a></div>
                                    <div class="toc-subitem"><a href="#world" class="link-TOC">C) Les missions et le monde de l’entreprise.</a></div>
                                    <div class="toc-item"><a href="#apport" class="link-TOC">III) Les apports du stage.</a></div>
                                    <div class="toc-subitem"><a href="#pro" class="link-TOC">A) Les apports professionnels.</a></div>
                                    <div class="toc-subitem"><a href="#skill" class="link-TOC">B) Les compétences acquises et améliorées.</a></div>
                                    <div class="toc-item"><a href="#difficult" class="link-TOC">IV) Les difficultés du stage et les solutions apportées.</a></div>
                                    <div class="toc-subitem"><a href="#diff-rencontre" class="link-TOC">A) Les difficultés rencontrées.</a></div>
                                    <div class="toc-subitem"><a href="#solution" class="link-TOC">B) Les solutions apportées à ces difficultés.</a></div>
                                    <div class="toc-item"><a href="#conclusion" class="link-TOC">V) Conclusion.</a></div>
                                    <div class="toc-item"><a href="#annexe" class="link-TOC">VI) Annexes.</a></div>
                                </div>

                                <h4 class="title-ident" id="remerciement">Remerciements.</h4>
                                <div class="stage">
                                    <p>
                                        Je souhaite tout d’abord remercier Mme Dominique Baillargeat au poste de Directrice Générale d’avoir accepté de m’accueillir comme stagiaire au sein du groupe 3il ingénieur.
                                        <br><br>
                                        Je remercie ensuite mon maître de stage M. Oulad Moussa Mustapha qui tout au long de mon stage m’a conseillé, aidé et accompagné lors de mes missions.
                                        <br><br>
                                        Mes remerciements à l’équipe pédagogique de l’Institution Beaupeyrat pour m’avoir apporté l’aide théorique et pratique nécessaire au bon déroulement du stage.
                                        <br><br>
                                        J’adresse également mes remerciements à MARTIN Maxence au poste d’administrateur Systèmes et Réseaux pour son accueil chaleureux, les conseils prodigués et son accompagnement tout
                                        au long de mon stage ainsi que les deux stagiaires en deuxième année de prépa ingénieur qui m’ont appris beaucoup de choses.
                                        <br><br>
                                        Enfin, je tiens à remercier M. Sautour Florent de m’avoir
                                        conseillé sur la manière dont je pouvais commencer à mettre en place le sujet de mon stage.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="introduction">Introduction.</h4>
                                <div class="stage">
                                    <p>
                                        En première année de BTS SIO (Service Informatique aux Organisations) à l’Institution Beaupeyrat,
                                        j’ai effectué mon stage au sein du groupe 3il ingénieur situé à Limoges du 29 mai 2023 au 29 juin 2023.<br><br>
                                        J’ai choisi de faire mon stage au sein du groupe 3il ingénieur car je souhaite pouvoir faire mon bachelor et mon mastère en cybersécurité chez eux par la suite.
                                        De plus, ils étaient en total capacité de pouvoir me proposer un sujet en adéquation avec mon option de BTS. <br><br>
                                        Grâce à cette expérience pratique, j’ai eu l’opportunité de découvrir l’usage d’outils de capture et de déploiement d’image mais aussi la configuration d’un
                                        serveur Fujitsu en raid 5.<br><br>
                                        J’ai pu développer de nombreuses compétences telles que la gestion de sauvegarde, le déploiement d’un service et la création d’une documentation détaillée.<br><br>
                                        Ce stage est pour moi un tremplin pour mon avenir professionnel. En effet, il m’a permis d’avoir une réflexion assez poussée par rapport à la sécurité du service
                                        que je mets en place et m’a conforté dans mon choix de partir sur des études pour travailler ensuite dans le pentesting.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="pres">Présentation de Groupe 3il ingénieur.</h4>
                                <div class="stage">
                                    <p>
                                        Le Groupe 3il a été créé le 1er janvier 1993, c’est une association loi 1901 à but non lucratif et n’a donc pas de capital social.
                                        Cette association dispense des cours d’enseignement supérieur. Elle dispense notamment des cours pour un cycle ingénieur, des bachelor ou encore des mastères.
                                        Sur l’année 2021-2022, l’association a généré un chiffre d’affaires de 5 777 945€.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="stage">Le stage au sein de cette association.</h4>
                                <div class="stage">
                                    <p>
                                        Mon stage s’est déroulé au service «Administration système». Tout au long de ce dernier, j’ai été épaulé par Monsieur MARTIN Maxence, mon tuteur et Monsieur OULAD-MOUSSA Mustapha,
                                        mon maître de stage. J’ai eu la possibilité de découvrir différentes facettes de la profession d’administrateur réseau.<br><br>
                                        Les conditions du stage ont été excellentes. En effet, le Groupe 3il a mis à ma disposition du matériel et une salle afin d’avoir un environnement de travail adéquat à ma mission
                                        de stage. Pour ce qui est du matériel j’ai pu avoir accès à un switch, des ordinateur fixe afin de créer un réseau interne/local pour que je puisse tester plusieurs scénarios.<br><br>
                                        Ma mission de stagiaire a demandé beaucoup d’autonomie. Effectivement, mon tuteur ou mon maître de stage étant très occupé, je devais me débrouiller seul, avec j’avais tout de même la
                                        possibilité de contacter mon tuteur si vraiment je rencontrais un problème. Cependant la nécessité d’autonomie m’a permis d’augmenter considérablement mon efficacité et la précision de
                                        mes recherches.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="obj">Objectif et problématique du stage.</h4>
                                <div class="stage">
                                    <p>
                                        Le fait de devoir installer plusieurs ordinateurs en grosse quantité peut être un frein. Mais ce n’est pas le cas pour le groupe 3il qui, lui, a déjà mis en place une solution de
                                        masterisation et de clonage de poste afin de les déployer massivement lors d’une installation d’ordinateurs dans une salle de classe. Cependant le groupe 3il souhaitait faire un
                                        comparatif entre leur solution, clonezila, et l’utilisation de Fog Project, sujet de mon stage.<br><br>
                                        En effet il m’a été demandé de mettre en place une solution de masterisation et de clonage en utilisant Fog Project et de faire une documentation sur Fog Project.<br><br>
                                        La mission que j’ai réalisée m’a permis de vivre le monde de l’entreprise. Elle est le fil conducteur de mon rapport de stage.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="stage2">I) Le stage au sein de l'entreprise.</h4>
                                <h4 class="title-ident2" id="infra">A) Structre et organisation du groupe 3IL.</h4>
                                <div class="stage">
                                    <p>
                                        Le Groupe 3il est une association loi 1901 à but non lucratif. Le Groupe est implanté à Limoges au 43 rue Sainte-Anne.
                                        Le groupe emploie environ 450 salariés.<br><br>
                                        Les employés sont sous la direction de Madame Baillargeat Dominique, directrice générale du Groupe 3il.<br><br>
                                        Un organigramme fonctionnel illustre l’organisation interne de l’entreprise à l’annexe n°1.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="service">B) Les services au sein du groupe 3IL.</h4>
                                <div class="stage">
                                    <p>
                                        Le groupe 3il se compose des services suivants :<br><br>
                                            <span class="title-ident">- 3IL Alliance (partenaires programmes Experts titres -RNCP).<br><br></span>
                                            <span class="title-ident">- Un service Pôle informatique Direction des Programmes.<br><br></span>
                                            <span class="title-ident">- Un service Vie Etudiante.<br><br></span>
                                            <span class="title-ident">- Un service Scolarité.<br><br></span>
                                            <span class="title-ident">- Un service Equipe Enseignante et coordination pédagogique.<br><br></span>
                                            <span class="title-ident">- 3IL Lab.<br><br></span>
                                            <span class="title-ident">- Un service Ressources technologiques et pédagogiques.<br><br></span>
                                            <span class="title-ident">- Un service Direction générale.<br><br></span>
                                            <span class="title-ident">- Un service Direction administrative et financière.<br><br></span>
                                            <span class="title-ident">- Un service Relation internationales.<br><br></span>
                                            <span class="title-ident">- Un service Relation entreprises.<br><br></span>
                                            <span class="title-ident">- Un service Secrétariat général.<br><br></span>
                                            <span class="title-ident">- Un service Admissions Concours.<br><br></span>
                                            <span class="title-ident">- Un service DSI.<br><br></span>
                                            <span class="title-ident">- Un service Entretien et logistique.<br><br></span>
                                            <span class="title-ident">- Un service Développement et communication.<br><br></span>
                                        Tout ces services sont présents sur l'organigramme fonctionnel présent en annexe n°1.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="mission">II) Missions effectuées.</h4>
                                <h4 class="title-ident2" id="main">A) Missions principales.</h4>
                                <div class="stage">
                                    <p>
                                        Je me suis très rapidement adapté à l’environnement du Groupe. Il m’a été assez facile de m’immerger dans les missions confiées.
                                        En effet, j’ai compris ce qu’on attendait de moi, et l’importance de réaliser le travail de manière approfondi ainsi que la création
                                        d’une documentation complète. Pour ce stage, il m’a été demandé de mettre en place une solution de masterisation et de clonage en utilisant
                                        Fog Project qui est un outil de clonage et de déploiement.<br><br>
                                        J’ai petit à petit appris à utiliser les outils mis à ma disposition. En effet, j’ai acquis de nouvelles connaissances et compétences telles
                                        que la gestion d’outils de clonage et de déploiement, la création d’un Active Directory, l’installation d’un OS sur un serveur avec raid 5 ou
                                        encore la manipulation de disques durs et de données que ce soit en lignes de commande sous Linux ou en interface graphique sous Windows.
                                        J’ai également pu affiner ma méthode de recherche d’information qui m’a beaucoup aidée car pour mon sujet de stage il existe très peu de documentation
                                        expliquant tout correctement, il a donc fallu que je cherche des solutions en recherchant sur des forums, des sites internet dédié au sujet
                                        mais incomplet ou pas mis à jour, ou en testant les différentes options proposées par le service Fog.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="second">B) Missions secondaires</h4>
                                <div class="stage">
                                    <p>
                                        Lors de ce projet et de mes recherches je me suis rendu qu’il y avait beaucoup d’options proposées par Fog Project qui pourraient intéresser mon tuteur,
                                        notamment le fait de pouvoir faire exécuter un script post-déploiement ou encore de pouvoir mettre des applications ou des scripts en «Snapin».
                                        Les applications ou scripts mis en «Snapin» peuvent être déployés sur les machines ou groupe de machines que l’on veut et installer ou exécuter
                                        un script à distance.<br><br>
                                        Mon tuteur m’a donc demandé de pousser mes recherches et de tout documenter sur les possibilités offertes par Fog Project.<br><br>
                                        J’ai donc réalisé une documentation complète de Fog Project et mon tuteur m’a demandé de lui expliquer comment je ferais pour faire le déploiement
                                        d’une salle avec plusieurs ordinateurs à déployer, je lui ai donc fait part de ma réflexion et de pourquoi je ferais certaines choses et pas d’autres.<br><br>
                                        J’ai également pu aider mon tuteur pour la configuration des switches des différentes salles de cours.<br><br>
                                        Pendant que mon tuteur était en salle des serveurs j’allais dans les différentes salles de cours afin de pouvoir tester si la nouvelle configuration fonctionné correctement.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="world">C) Les missions et le monde de l'entreprise.</h4>
                                <div class="stage">
                                    <p>
                                        Le monde de l'entreprise se caractérise par des services qui interagissent. Chaque service a un rôle précis à jouer pour le bon fonctionnement de l'entreprise.
                                        Dans le cadre de mes missions, j'ai été amené à communiquer avec mon tuteur en tant qu’administrateur réseau afin de pouvoir bien comprendre le fonctionnement
                                        du réseau et ainsi pouvoir adapter mon travail à la structure.<br><br>
                                        Lors de ce stage, j’ai adopté les valeurs du Groupe 3il ainsi qu’un comportement professionnel. En effet, j’ai été amené à rencontrer des permanents du groupe 3il.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="apport">III) Les apports du stage</h4>
                                <h4 class="title-ident2" id="pro">A) Les apports professionnels.</h4>
                                <div class="stage">
                                    <p>
                                        Les apports du stage ont été nombreux car j’ai vraiment plongé au cœur du métier. J’ai pu affiner mon projet professionnel et ce stage m’a conforté dans l’idée de
                                        travailler dans le secteur du pentesting. En effet tout au long de ma mission, je réfléchissais à comment faire pour que ce soit le plus sécurisé possible, en
                                        essayant de comprendre et de voir ce qui pourrait poser des problèmes.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="skill">B) Les compétences acquises et améliorées.</h4>
                                <div class="stage">
                                    <p>
                                        Au cours de ce stage, j’ai acquis diverse compétences telles que la gestion des sauvegardes et la gestion du déploiement d’un service, la création d’un Active
                                        Directory sur un Windows server 2022, mais également la création d’un serveur Windows server 2022 et la configuration d’un DHCP sous Windows server 2022.<br><br>
                                        J’ai pu également consolider mes compétences déjà acquises telles que l’usage d’un Linux et des différentes commandes, la création de script bash/ batch ainsi
                                        que mon niveau en anglais car la plupart de la documentation est en anglais.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="difficult">IV) Les difficultés du stage et les solutions apportées</h4>
                                <h4 class="title-ident2" id="diff-rencontre">Les difficultés rencontrées.</h4>
                                <div class="stage">
                                    <p>
                                        J’ai rencontré des difficultés lors de mon stage. Les missions confiées n’ont pas toujours été évidentes à effectuer. Toutefois, avec le temps j’ai su m’adapter
                                        et changer ma méthode de travail et de recherche afin de pouvoir affronter ces quelques obstacles.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="solution">Les solutions apportées à ces difficultés.</h4>
                                <div class="stage">
                                    <p>
                                        Pour la plupart de mes problèmes j’ai pu les résoudre seul à force de recherches et de tests, mais pour certains problèmes j’ai demandé de l’aide à mon tuteur ou
                                        mon maître de stage si je ne trouvais vraiment pas de solution. Afin d’illustrer mon propos, je vais vous donner deux exemples, un que j’ai résolu seul et un pour
                                        lequel j’ai demandé de l’aide à mon tuteur ou maître de stage.<br><br>
                                        Lors de mon stage, je me suis trouvé confronté au problème qu’il fallait que je capture une image d’un ordinateur en dualboot Windows10/linux, le problème étant
                                        que pour la capture d’une image, Windows Fog est très efficace, cependant pour la capture d’un linux ou d’un dualboot, Fog n’est pas performant.
                                        En effet lorsque nous voulons capturer une image il faut créer une image via l’interface graphique du serveur Fog et lui attribuer un type d’image,
                                        et selon le type d’image utilisé cela peut poser des problèmes car, en effet pour la capture d’un linux ou un dualboot il faut utiliser un type d’image particulier,
                                        qui prenne en charge le chargeur GRUB, il m’a fallu beaucoup de recherche et de tests afin de comprendre comment cela fonctionnait.
                                        Au bout d’un moment j’ai fini par réussir à capturer une image. Cependant, lors du déploiement, je me suis rendu compte que la capture avait cassé le boot grub.
                                        J’ai donc réalisé un script bash en post-déploiement afin qu’il répare le boot grub si ce dernier était endommagé, malheureusement le script n’a pas fonctionné.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="conclusion">V) Conclusion.</h4>
                                <div class="stage">
                                    <p>
                                        Pour conclure, se stage ma permis de découvrir un outil de clonage et de déploiement puissant, FOG Project, a fur et à mesure de mes recherches j’ai pu découvrir
                                        la puissance de tels outils et la nécessité d’avoir un tel outil au sein d’une structure assez grosse car cela permet de pouvoir installer et/ou renouveler un nombre
                                        d’ordinateur très important en un temps minimum.<br><br>
                                        Grâce à se stage, j’ai acquis de nouvelle compétence comme la gestion de sauvegarde ou encore à approfondir mes recherches en autonomie et a synthétisé pour créer une
                                        documentation technique sur l’utilisation de l’outil sur lequel j’ai travaillé.<br><br>
                                        J’ai réussi à atteindre les objectifs demandés qui était de mettre en place une maquette de clonage et de masterisation en utilisant l’outil Fog, j’ai également pu
                                        pousser le sujet plus long en utilisant des fonction plus avancé de Fog comme les Snapin, qui mon permis notamment de pouvoir déployer un script post déploiement pour
                                        faire la configuration IP des machines ce qui évite aux personnes concerné de devoir repasser physiquement sur chaque machine pour les configurer, ou encore l’intégration
                                        à un Active Directory, malheureusement je n’ai pas vraiment réussi a faire fonctionner cette fonctionnalité correctement en effet il faudrait faire des recherche plus
                                        poussé et faire plus de teste afin de comprendre comment se comporte réellement cette fonctionnalité.<br><br>
                                        Ce stage ma permis d’affiner mon projet professionnel tout en renforçant mon idée principale qui est de m’orienter vers le pentesting. En effet tout au long de mon stage
                                        j’ai pu réfléchir a comment est-ce que ce que je mettais en place pouvais être attaqué, par où et comment et par conséquence penser à comment l’on pourrait sécuriser l’outil.
                                        Le but de cette réflexion était une réflexion personnelle car toutes les solutions que j’ai imaginées sont déjà mise en place au sein du groupe 3il.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="annexe">VI) Annexes.</h4>
                                <h4 class="title-ident2">Organigramme : </h4>
                                <div class="stage">
                                    <a href="assets/img/OrganigrammesGroupe3iL_2023%20juin_page-0001.jpg"><img src="assets/img/OrganigrammesGroupe3iL_2023%20juin_page-0001.jpg" width="1080px"></a>
                                </div>
                                <h4 class="title-ident2">Documentations réalisées : </h4>
                                <div>
                                    <div class="row certif">
                                        <div class="col-md-4 img-aws">
                                            <div class="flex-woaw">
                                                <div class="service-box certif-box test">
                                                    <div class="service-content">
                                                        <h2 class="s-title cve-title">Fog project </h2>
                                                        <img src="assets/img/fogproject-removebg.png" alt="">
                                                        <p>Guide utilisateur</p>
                                                    </div>
                                                </div>
                                                <div class="pdf">
                                                    <embed src="assets/DocFogProject.pdf" type="application/pdf"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="row certif">
                                        <div class="col-md-4 img-aws">
                                            <div class="flex-woaw">
                                                <div class="service-box certif-box test">
                                                    <div class="service-content">
                                                        <h2 class="s-title cve-title">Fog project </h2>
                                                        <img src="assets/img/fogproject-removebg.png" alt="">
                                                        <p>Création d'un user</p>
                                                    </div>
                                                </div>
                                                <div class="pdf">
                                                    <embed src="assets/crea_userufogproject.pdf" type="application/pdf"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="second" class="about-mf sect-pt4 route">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="box-shadow-full">
                        <div class="row">
                            <div>
                                <h5 class="title-center title-left">Stage de deuxième année</h5>
                                <div class="table-of-contents">
                                    <h3 class="h3-TOC">Table des matières</h3>
                                    <div class="toc-item"><a href="#remerciement" class="link-TOC">Remerciement.</a></div>
                                    <div class="toc-item"><a href="#introduction" class="link-TOC">Introduction.</a></div>
                                    <div class="toc-item"><a href="#pres" class="link-TOC">Présentation d'Iconosquare'.</a></div>
                                    <div class="toc-item"><a href="#stage" class="link-TOC">Le stage au sein d'Iconosquare'.</a></div>
                                    <div class="toc-item"><a href="#obj" class="link-TOC">Objectif et problématique du stage.</a></div>
                                    <div class="toc-item"><a href="#mission" class="link-TOC">I) Missions effectuées.</a></div>
                                    <div class="toc-subitem"><a href="#main" class="link-TOC">A) Missions principales.</a></div>
                                    <div class="toc-subitem"><a href="#second" class="link-TOC">B) Missions secondaires.</a></div>
                                    <div class="toc-subitem"><a href="#world" class="link-TOC">C) Les missions et le monde de l’entreprise.</a></div>
                                    <div class="toc-item"><a href="#apport" class="link-TOC">II) Les apports du stage.</a></div>
                                    <div class="toc-subitem"><a href="#pro" class="link-TOC">A) Les apports professionnels.</a></div>
                                    <div class="toc-subitem"><a href="#skill" class="link-TOC">B) Les compétences acquises et améliorées.</a></div>
                                    <div class="toc-item"><a href="#difficult" class="link-TOC">III) Les difficultés du stage et les solutions apportées.</a></div>
                                    <div class="toc-subitem"><a href="#diff-rencontre" class="link-TOC">A) Les difficultés rencontrées.</a></div>
                                    <div class="toc-subitem"><a href="#solution" class="link-TOC">B) Les solutions apportées à ces difficultés.</a></div>
                                    <div class="toc-item"><a href="#conclusion" class="link-TOC">IV) Conclusion.</a></div>
                                    <div class="toc-item"><a href="#annexe" class="link-TOC">V) Annexes.</a></div>
                                </div>
                                <h4 class="title-ident" id="remerciement">Remerciements.</h4>
                                <div class="stage">
                                    <p>
                                        Je souhaite tout d’abord remercier M. Pierre-Alexandre Malaguise au poste de Responsable des Ressources Humaines d’avoir accepté de m’accueillir comme stagiaire au sein d’Iconosquare.
                                        <br><br>
                                        Je remercie ensuite mon maître de stage, M. Munoz Jeremy, qui tout au long de mon stage m’a conseillé, aidé et accompagné lors de mes missions.
                                        <br><br>
                                        Mes remerciements à l’équipe pédagogique de l’Institution Beaupeyrat pour m’avoir apporté l’aide théorique et pratique nécessaire au bon déroulement du stage.
                                        <br><br>
                                        J’adresse également mes remerciements à Airault Nicolas pour son accueil chaleureux, les conseils prodigués et son accompagnement tout au long de mon stage.
                                        <br><br>
                                        Enfin, je tiens à remercier M. Sautour Florent de m’avoir conseillé sur la manière dont je pouvais commencer à mettre en place le sujet de mon stage.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="introduction">Introduction.</h4>
                                <div class="stage">
                                    <p>
                                        En deuxième année de BTS SIO (Service Informatique aux Organisations) à l’Institution Beaupeyrat, j’ai effectué mon stage au sein d’Iconosquare, situé à Limoges au 12 rue Armand Bardès, du 08 janvier 2024 au 23 février 2024.<br><br>
                                        J’ai choisi de faire mon stage au sein du groupe 3il ingénieur car je souhaite pouvoir faire mon bachelor et mon mastère en cybersécurité chez eux par la suite.
                                        J’ai choisi de faire mon stage au sein d’Iconosquare car c’était une opportunité pour moi de pouvoir accroitre mes connaissances en ce qui concerne la gestion d’un SI sur le cloud. De plus,
                                        ils étaient en total capacité de pouvoir me proposer un sujet en adéquation avec mon option de BTS, ainsi que pour ma poursuite d’étude. <br><br>
                                        Grâce à cette expérience pratique, j’ai eu l’opportunité de découvrir l’usage d’outils d’Infrastructure As Code (IaC), d’une utilisation avancée de Gitlab, ainsi que confirmé mes compétences dans la réalisation de script divers.<br><br>
                                        J’ai pu développer de nombreuses compétences telles que l’utilisation d’un langage IaC, l’utilisation des métriques pour analyser l’infrastructure et faire de la Recherche et Développement sur les Features flag pour le backend et le frontend.<br><br>
                                        Ce stage est pour moi un tremplin pour mon avenir professionnel. En effet il m’a permis d’avoir une réflexion assez poussée par rapport à la sécurité d’une Infra cloud gérer par
                                        du code et m’a conforté dans mon choix sur mon parcours professionnel pour a termes travailler dans le pentesting.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="pres">Présentation d'Iconosquare.</h4>
                                <div class="stage">
                                    <p>
                                        Iconosquare apparu en 2011 sous le nom de Statigram évolue très rapidement et c’est en 2015 que Statigram change de marque pour devenir Iconosquare.
                                        En 2015 la plateforme rencontre un immense succès et se classe parmi les 800 sites web les plus visités au monde avec dix millions d’utilisateur enregistrés.<br><br>
                                        En 2022, le groupe Wedia a suscité un intérêt pour Iconosquare qui souhait doter son offre logicielle de la puissante solution d’analyse, de gestion et de programmation d’Iconosquare dédiée aux marques et aux agences du monde entier.<br><br>
                                        Aujourd'hui, Iconosquare compte plus de 40 employés à temps plein, originaires de 11 pays différents. Cette équipe dynamique, ouverte d'esprit est répartie sur deux sites.<br><br>
                                        Le siège de la société est situé dans la ville de Limoges, en France, et le deuxième bureau se trouve à Berlin, en Allemagne.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="stage">Le stage au sein d'Iconosquare.</h4>
                                <div class="stage">
                                    <p>
                                        Mon stage s’est déroulé au service «Administration système». Tout au long de ce dernier, j’ai été épaulé par Monsieur AIRSAULT Nicolas, mon tuteur et Monsieur MUNOZ Jeremy, mon maître de stage.
                                        J’ai eu la possibilité de découvrir différentes facettes de la profession d’administrateur IT.<br><br>
                                        Les conditions du stage ont été excellentes. En effet, Iconosquare a mis à ma disposition tout le matériel nécessaire afin d’avoir un environnement de travail adéquat à ma mission de stage,
                                        j’ai également été très agréablement surpris par la qualité du bon vivre et des locaux d’Iconosquare. Pour ce qui est du matériel j’ai pu avoir accès à un ordinateur portable (mac),
                                        ainsi que des accès à certains comptes pour réaliser au mieux la missions qui m’a était donné. J’ai également eu l’opportunité de pouvoir travailler sur trois autres projets en parallèle cela
                                        m’a permis de mettre en place une réflexion beaucoup plus poussée afin de pouvoir contourner les différents problème survenu.<br><br>
                                        J’ai pu travailler en autonomie. Effectivement, mon tuteur ou mon maître de stage étant très occupé, je devais me débrouiller seul, j’avais tout de même la possibilité de contacter mon tuteur
                                        si vraiment je rencontrais un problème. Cependant la nécessité d’autonomie m’a permis d’augmenter considérablement mon efficacité et la précision de mes recherches. Malgré le fait que j’étais
                                        en autonomie toutes les personnes de l’entreprise répondait présent lorsque je leur demandais de l’aide. J’ai également été intégré aux réunions hebdomadaires auquel je pouvais également échanger
                                        avec les équipes sur ma progression et les difficultés éventuellement rencontrées.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="obj">Objectif et problématique du stage.</h4>
                                <div class="stage">
                                    <p>
                                        Le fait de gérer beaucoup de donnée d’utilisateur génère forcément des inquiétudes auprès des utilisateur il faut donc que l’entreprise leur prouve que les données qu’il possède sont bien protégé pour
                                        cela une entreprise peut passer des certifications de qualité, comme la norme ISO 27001, ou encore faire des pentest pour attester qu’il n’y a pas de failles potentiellement exploitables.<br><br>
                                        En ce qui concerne ma mission j’ai dû proposer des améliorations du code IaC, terraform, afin de répondre aux alertes de datadog par rapport à la norme ISO 27001 afin que l’infra soit conforme à celle-ci pour qu’Iconosquare puisse obtenir la certification.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="mission">I) Missions effectuées.</h4>
                                <h4 class="title-ident2" id="main">A) Missions principales.</h4>
                                <div class="stage">
                                    <p>
                                        e me suis très rapidement adapté à l’environnement d’Iconosquare. Il n’a pas été aisé de m’immerger dans les missions confiées. En effet, j’ai compris ce qu’on attendait de moi,
                                        et l’importance de réaliser le travail de manière approfondi, cependant la complexité du code de l’infra ma donnée quelque difficultés au début que j’ai su surmonter assez rapidement
                                        pour être opérationnel le plus rapidement possible. Pour ce stage, il m’a été demandé de faire des proposition d’amélioration du code terraform afin de résoudre les alertes de sécurité
                                        de datadog afin de répondre au mieux à la norme ISO 27001.<br><br>
                                        J’ai petit à petit appris à utiliser les outils mis à ma disposition. En effet, j’ai acquis de nouvelles connaissances et compétences telles que l’utilisation d’un langage IaC, l’utilisation
                                        de la plateforme de gestion datadog, l’utilisation approfondi de Gitlab. J’ai également pu affiner ma méthode de recherche d’informations qui m’a beaucoup aidée car pour mon sujet de stage
                                        il existe de la  documentation expliquant tout correctement mais pas forcément pour l’usage que je souhaitais, il a donc fallu que je cherche des solutions en recherchant sur des forums,
                                        des sites internet dédié au sujet mais incomplet ou pas mis à jour, ou en testant les différentes options le tout avec la supervision de mon tuteur et de mon maitre de stage qui ont vérifiés tout ce que j’ai proposé via les merge request de Gitlab.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="second">B) Missions secondaires</h4>
                                <div class="stage">
                                    <p>
                                        J’ai également eu trois autres sujets qui m’ont été donner au fur et à mesure de mon stage.<br><br>
                                        Le premier sujet concerne la réalisation d’un script afin d’importer dans une base redis les données de géolocalisation d’un grand nombre de ville du monde entier.
                                        J’ai rencontré plusieurs problèmes pour ce sujet, le premier est qu’il fallait que le script soit obligatoirement écrit en JavaScript, mais avec quelque recherche bien mené j’ai réussi à faire ce qu’il fallait.
                                        Le second problème à était de trouver le meilleur type d’enregistrement redis pour l’utilisation que voulait en faire Iconosquare.
                                        Enfin le dernier et pas des moindre qui valut la mise de côté du projet bien que j’ai réussi à faire le script est que le nom des villes récupérer par la plateforme Iconosquare sont récupérer dans la langue de
                                        l’utilisateur et pas uniquement en anglais ce qui complique très fortement le fait de pouvoir requêter sur les noms dans la base redis, par exemple un utilisateur en Pologne renverras le nom de sa ville en
                                        Polonais il est donc impossible de pouvoir trouver la ville dans la base redis car tous les noms sont en anglais.<br><br>
                                        voir <a href="#redis" class="link-TOC">Annexe</a><br><br>
                                        Le deuxième sujet concerné la réalisation d’un serveur Prometheus pour faire du monitoring des version des différents services installé dans l’infra. Après de longue recherche sur ce sujet il s’avère que la mise
                                        en place d’un serveur Prometheus aurait demandé beaucoup trop d’effort pour la mise en place j’ai donc effectué des recherches pour faire la même chose mais de manière plus simple.
                                        J’ai fini par opter pour l’option de créer un script python qui serait exécuter sur une lambda aws tous les jours a qui via les métriques récupérer dans datadog récupère la version des service installé puis fait
                                        une vérification sur les repo officielle de chaque service pour trouver la dernière version disponible et si les version sont différente le script envoie un évènement à datadog pour alerter que le service en question n’est pas à jour.
                                        Cette option à était validé par mon tuteur et mon maitre de stage qui ont trouvé cette solution très intéressante. Cependant j’ai rencontré quelque difficulté notamment au moment de mettre mon script sur la lambda car bien que la lambda
                                        possède des modules de base de python il fallait que j’importe les modules nécessaire pour mon script. En revanche comme Iconosquare utilise terraform (langage IaC) pour déployer son infra il a fallu que je trouve comment faire pour
                                        importer les modules nécessaire et cela a était assez compliqué car très peu de documentation explicite à ce sujet mais après plusieurs tentative infructueuse j’ai trouvé d’où venait le problème et j’ai réussi à faire fonctionner la
                                        lambda comme il faut.<br><br>
                                        voir <a href="#versioning" class="link-TOC">Annexe</a><br><br>
                                        Le troisième sujet lui consisté à faire de la Recherche et Développement sur les Features flag pour le backend (laravel/php) et le frontend (React/Next) et comment faire pour pouvoir utiliser la nouvelle option de Gitlab pour gérer les Features flags.
                                        J’en ai donc profité pour faire des tests en local pour vraiment comprendre comment cela fonctionner et pouvoir répondre au mieux aux attentes. Il m’a donc était demandé de faire de la R&D sur ce sujet puis de faire une documentation pour les dev backend et frontend.
                                        Le travail et les test étant concluant mon maitre de stage ma donc demandé de faire une présentation et une démonstration pour les dev afin de leur expliquer comment mettre en place les Features flag dans leurs code et comment bien tout configuré.<br><br>
                                        voir <a href="#featureFlag" class="link-TOC">Annexe</a><br><br>
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="world">C) Les missions et le monde de l'entreprise.</h4>
                                <div class="stage">
                                    <p>
                                        Le monde de l'entreprise se caractérise par des services qui interagissent. Chaque service a un rôle précis à jouer pour le bon fonctionnement de l'entreprise.
                                        Dans le cadre de mes missions, j'ai été amené à communiquer avec mon tuteur en tant qu’administrateur réseau afin de pouvoir bien comprendre le fonctionnement du réseau et ainsi pouvoir adapter mon travail à la structure.<br><br>
                                        Lors de ce stage, j’ai adopté les valeurs d’Iconosquare ainsi qu’un comportement professionnel. En effet, j’ai été amené à participer aux différentes réunions.
                                        J’ai également pu me rendre compte de la nécessité de bien s’exprimer en anglais qui aujourd’hui est indispensable dans le monde professionnel de l’informatique.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="apport">II) Les apports du stage</h4>
                                <h4 class="title-ident2" id="pro">A) Les apports professionnels.</h4>
                                <div class="stage">
                                    <p>
                                        Les apports du stage ont été nombreux car j’ai vraiment plongé au cœur du métier. J’ai pu affiner mon projet professionnel et ce stage m’a conforté dans l’idée de travailler dans le secteur du pentesting.
                                        En effet, ma mission consisté à proposer des amélioration du code terraform pour résoudre les alertes de sécurité de datadog pour répondre à la norme ISO 27001, cela m’a montré à quel point le monde de
                                        la cybersécurité est complexe et vaste et cela ne fait qu’accroître mon envie de poursuivre dans ce domaine. J’ai également pu participer au réunion pour faire faire un pentest et je me suis rendu compte
                                        à quel point un pentest est nécessaire pour mettre en confiance les utilisateurs.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="skill">B) Les compétences acquises et améliorées.</h4>
                                <div class="stage">
                                    <p>
                                        Au cours de ce stage, j’ai acquis diverse compétences telles que l’utilisation du cloud aws, la création d’une infra cloud aws via du code terraform, analyser et corriger les problème de sécurité cloud
                                        via les alertes datadog, ainsi que l’utilisation du langage JavaScript pour réaliser un script. J’ai également pu participer au début du processus d’un pentest, ce qui m’a conforté dans mon projet
                                        professionnel de travailler à termes dans le monde du pentest.<br><br>
                                        J’ai pu également consolider mes compétences déjà acquises telles que l’utilisation de docker, la Recherche et Développement sur les Features flags, la création de script python ainsi que mon niveau en anglais car toutes les documentation sont en anglais.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="difficult">III) Les difficultés du stage et les solutions apportées</h4>
                                <h4 class="title-ident2" id="diff-rencontre">A) Les difficultés rencontrées.</h4>
                                <div class="stage">
                                    <p>
                                        J’ai rencontré des difficultés lors de mon stage. Les missions confiées n’ont pas toujours été évidentes à effectuer.
                                        Toutefois, avec le temps j’ai su m’adapter et changer ma méthode de travail et de recherche afin de pouvoir affronter ces quelques obstacles.<br><br>
                                        En effet j’ai passé beaucoup de temps à effectuer des recherche et à test beaucoup de chose car dans les documentations officiel l’usage de ce dont j’avais besoin n’était pas forcément expliqué, bien qu’évoque comme étant possible.<br><br>
                                        J’ai également été confronté à des problèmes technique qui ont eu pour conséquence de ne pas mettre en application dans l’immédiat mes propositions d’amélioration, comme pour ma proposition pour modifier la façon dont les logs pour les alb
                                        (aws Application Load Balancer) où mon code à était commenter car il y a des problèmes de droits sur le bucket s3, où sont stocker les logs. La correction de c’est droit étant assez complexe c’est pour cela que mon code n’est pas mis en
                                        place dans l’immédiat.
                                    </p>
                                </div>
                                <h4 class="title-ident2" id="solution">B) Les solutions apportées à ces difficultés.</h4>
                                <div class="stage">
                                    <p>
                                        A force de persévérance, de recherche et de test j’ai réussi à résoudre la plupart de mes problèmes. Bien évidement pour certain sujet j’ai d’abord fait par à mon tuteur et mon maître de stage de mes recherches et
                                        solutions que je penser adéquat pour qu’il confirme. Certaine solution on était validé et pour certaine ont était refusé car impossible à mettre en place dans le cadre de l’infra et mon orienté vers de potentiel autre solution.<br><br>
                                        C’est nombreux échange mon permis d’acquérir un esprit plus critique sur mon travail pour l’adapter au mieux à l’entreprise pour pouvoir proposer les solutions les plus adaptées.<br><br>
                                        Pour le second sujet qui concerne le serveur Prometheus au cours de mes recherches je me suis rendu que la mise en place d’un tels serveur aller être très complexe pour l’utilisation qu’Iconosquare en aurait fait. En effet,
                                        un serveur Prometheus seul ne sert à rien, il a besoin d’une infra particulière pour qu’il puisse fonctionner correctement, voici un diagramme illustrant l’infra pour un serveur.<br>
                                        <img class="img-bg" src="assets/img/infra-prometheus.png" width="1080px">
                                    </p>
                                </div>
                                <h4 class="title-ident" id="conclusion">V) Conclusion.</h4>
                                <div class="stage">
                                    <p>
                                        Pour conclure, se stage ma permis de découvrir un outil de clonage et de déploiement puissant, FOG Project, a fur et à mesure de mes recherches j’ai pu découvrir
                                        la puissance de tels outils et la nécessité d’avoir un tel outil au sein d’une structure assez grosse car cela permet de pouvoir installer et/ou renouveler un nombre
                                        d’ordinateur très important en un temps minimum.<br><br>
                                        Grâce à se stage, j’ai acquis de nouvelle compétence comme la gestion de sauvegarde ou encore à approfondir mes recherches en autonomie et a synthétisé pour créer une
                                        documentation technique sur l’utilisation de l’outil sur lequel j’ai travaillé.<br><br>
                                        J’ai réussi à atteindre les objectifs demandés qui était de mettre en place une maquette de clonage et de masterisation en utilisant l’outil Fog, j’ai également pu
                                        pousser le sujet plus long en utilisant des fonction plus avancé de Fog comme les Snapin, qui mon permis notamment de pouvoir déployer un script post déploiement pour
                                        faire la configuration IP des machines ce qui évite aux personnes concerné de devoir repasser physiquement sur chaque machine pour les configurer, ou encore l’intégration
                                        à un Active Directory, malheureusement je n’ai pas vraiment réussi a faire fonctionner cette fonctionnalité correctement en effet il faudrait faire des recherche plus
                                        poussé et faire plus de teste afin de comprendre comment se comporte réellement cette fonctionnalité.<br><br>
                                        Ce stage ma permis d’affiner mon projet professionnel tout en renforçant mon idée principale qui est de m’orienter vers le pentesting. En effet tout au long de mon stage
                                        j’ai pu réfléchir a comment est-ce que ce que je mettais en place pouvais être attaqué, par où et comment et par conséquence penser à comment l’on pourrait sécuriser l’outil.
                                        Le but de cette réflexion était une réflexion personnelle car toutes les solutions que j’ai imaginées sont déjà mise en place au sein du groupe 3il.
                                    </p>
                                </div>
                                <h4 class="title-ident" id="annexe">VI) Annexes.</h4>
                                <h4 class="title-ident2">Sujet secondaire 1 : </h4>
                                <h4 class="title-ident3">Script JS :</h4>

                                <pre><code class="language-javascript">
&lt;script&gt;
    // Attention il y a des doublons dans le fichier cities500.txt par exemple pour Lakelands en Australie
    //il y a bien 2 Lakelands mais à positions différente en Australie
    // il faudra donc voir comment l'on peut résoudre le problème.
    // il y a également des doublons comme pour Xiji en Chine qui a 3 enregistrements dont un qui pointe sur la ville Xihe country
    //et l'autre sur Tongzhou Beijing.
    // Pour la récupération des données sur redis il faut utiliser hget soit "hgetall redisKey" pour récupérer toutes les infos soit
    //"hget redisKey longitude ou latitude".
    // pour récupérer uniquement longitude latitude /!\ avec hget il sera nécessaire de faire 2 appel
    //pour avoir les données 1 pour longitude et un pour latitude.

    const fs = require('fs');
    const readline = require('readline');
    const Redis = require('ioredis');

    const cluster = new Redis.Cluster([
      {
        port: 6373,
        host: "172.16.30.31",
      },
      {
        port: 6374,
        host: "172.16.30.32",
      },
      {
        port: 6375,
        host: "172.16.30.33",
      }
    ]);

    console.time('ImportationRedis');

    const citiesFilePath = '/usr/local/etc/redis/cities500.txt';
    const citiesStream = fs.createReadStream(citiesFilePath);
    const citiesReader = readline.createInterface({
      input: citiesStream,
      crlfDelay: Infinity,
    });

    citiesReader.on('line', async (line) => {
      try {
        // Structure du fichier cities500.txt
        const [
          geonameId,
          name,
          asciiname,
          alternatenames,
          latitude,
          longitude,
          featureClass,
          featureCode,
          countryCode,
          cc2,
          admin1Code,
          admin2Code,
          admin3Code,
          admin4Code,
          population,
          elevation,
          dem,
          timezone,
          modificationDate,
        ] = line.split('\t');

        // remplacez les majuscule par des minuscule
        const cleanName = asciiname.toLowerCase();

        // Utiliser le nom de la ville et du pays pour construire la clé Redis
        const redisKey = `${cleanName}`;
        const field = `${geonameId}:${cleanName}`;

        const value = JSON.stringify({
          name: asciiname,
          latitude: latitude,
          longitude: longitude,
          population: population,
          timezone: timezone,
          alternateName: alternatenames
        });

        // Si le block au-dessous est décommenter pour afficher les doublons il faut commenter les deux await ci-après
        // sinon ça fera l'enregistrement 4 fois.
        // les block await font l'enregistrement des données sur le cluster redis en utilisation la commande hset avec
        // en premier paramétre la clé (qui servira pour récupéré les infos) puis la liste champ = valeur des données
        // coreespondantes.

        // Ce block ci fait un enregistrement avec la clé redisKey ville:pays
        await cluster.hset(redisKey, field, value);

      } catch (error) {
        console.error(`Erreur lors de l'enregistrement : ${error.message}`);
      }
    });

    citiesReader.on('close', async () => {
      console.timeEnd('ImportationRedis');
      console.log('Importation terminée. Fermeture de la connexion Redis.');
      await cluster.quit();
    });


    cluster.on('error', (err) => console.log('Redis Cluster Error', err));
&lt;script&gt;
                                </code></pre>
                                <h4 class="title-ident3">docker-compose.yaml :</h4>
                                <pre><code class="language-yaml">
version: "3.9"

services:

  redis-cluster:
      image: 'redis:latest'
      command: redis-cli --cluster create 172.16.30.31:6373 172.16.30.32:6374 172.16.30.33:6375 --cluster-replicas 0 --cluster-yes
      networks:
        network-dev-stack:
          ipv4_address: 172.16.30.30
      depends_on:
        - redis-node-1
        - redis-node-2
        - redis-node-3

  redis-node-1:
    image: "redis:latest"
    container_name: redis-node-1
    hostname: redis-node-1
    command: redis-server /usr/local/etc/redis/redis.conf
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
    ports:
      - "6373:6373"
    volumes:
      - redis-node-1-data:/var/lib/redis
      - ./conf/redis/redis-node-1.conf:/usr/local/etc/redis/redis.conf
    networks:
      network-dev-stack:
        ipv4_address: 172.16.30.31

  redis-node-2:
    image: "redis:latest"
    container_name: redis-node-2
    hostname: redis-node-2
    command: redis-server /usr/local/etc/redis/redis.conf
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
    ports:
      - "6374:6374"
    volumes:
      - redis-node-2-data:/var/lib/redis
      - ./conf/redis/redis-node-2.conf:/usr/local/etc/redis/redis.conf
    networks:
      network-dev-stack:
        ipv4_address: 172.16.30.32

  redis-node-3:
    image: "redis:latest"
    container_name: redis-node-3
    hostname: redis-node-3
    command: redis-server /usr/local/etc/redis/redis.conf
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
    ports:
      - "6375:6375"
    volumes:
      - redis-node-3-data:/var/lib/redis
      - ./conf/redis/redis-node-3.conf:/usr/local/etc/redis/redis.conf
    networks:
      network-dev-stack:
        ipv4_address: 172.16.30.33

  redisinsight:
    image: redislabs/redisinsight
    container_name: redisinsight
    hostname: redisinsight
    restart: unless-stopped
    ports:
      - "8001:8001"
    networks:
      network-dev-stack:
        ipv4_address: 172.16.30.35

  nodeJS:
    image: "node:20"
    container_name: nodeJS
    hostname: nodeJS
    restart: unless-stopped
    command: tail -f /var/log/dpkg.log
    volumes:
      - ./import-script/import.js:/usr/local/etc/redis/import.js
      - ./import-script/cities500.txt:/usr/local/etc/redis/cities500.txt
      - ./import-script/countryInfo.txt:/usr/local/etc/redis/countryInfo.txt
    networks:
      network-dev-stack:
        ipv4_address: 172.16.30.36

volumes:
  redis-node-1-data:
  redis-node-2-data:
  redis-node-3-data:

networks:
  network-dev-stack:
    driver: bridge
    enable_ipv6: false
    ipam:
      driver: default
      config:
        - subnet: 172.16.30.0/24
          gateway: 172.16.30.1
                                </code></pre>
                                <h4 class="title-ident3">redis-node-1.conf :</h4>
                                <pre><code class="language-yaml">
port 6373
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
appendonly yes
                                </code></pre>
                                <h4 class="title-ident3">redis-node-2.conf :</h4>
                                <pre><code class="language-yaml">
port 6374
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
appendonly yes
                                </code></pre>
                                <h4 class="title-ident3">redis-node-3.conf :</h4>
                                <pre><code class="language-yaml">
port 6375
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
appendonly yes
                                </code></pre>
                                <h4 class="title-ident3">Screen : </h4>
                                <img src="assets/img/term-exec.png" alt="Résultat de l'execution du script" class="screen" >
                                <img src="assets/img/key.png" alt="Screen de l'enregistrement des clés" class="screen">
                                <img src="assets/img/key-content.png" alt="Contenu des clés" class="screen">
                                <h4 class="title-ident2">Sujet secondaire 2 :</h4>
                                <h4 class="title-ident4">Script python versioning :</h4>
                                <pre><code class="language-python">
import feedparser, re, requests, os
from datadog_api_client import ApiClient, Configuration
from datadog_api_client.v2.api.metrics_api import MetricsApi
from datadog_api_client.v1.api.events_api import EventsApi
from datadog_api_client.v1.model.event_create_request import EventCreateRequest

######### Configuration de l'API #########

configuration = Configuration(
    host="https://datadoghq.eu",
    api_key={
        'apiKeyAuth': os.environ.get(‘API_KEY’),
        'appKeyAuth': os.environ.get(‘APP_KEY’)
    }
)

######### Fonction pour version installée #########

# Fonction pour récupére la métric helm.release depuis datadog
def get_installed_version():
    try:
        with ApiClient(configuration) as api_client:
            api_instance = MetricsApi(api_client)

            response = api_instance.list_tags_by_metric_name(
                metric_name="helm.release",
            )
        # print(response)
        tags    = response['data']['attributes']['tags']

        # Récupérer que les tag "helm_chart"
        pattern = re.compile(r'^helm_chart:(.+?)-([a-zA-Z]*\d+\.\d+\.\d+(?:[._-]?\w*)?)$')

        # Block pour stocké dans un tableau le nom et la version
        helm_chart_data = []
        for tag in tags:
            if tag.startswith('helm_chart:'):
                match = pattern.match(tag)

                if match:
                    name, version = match.groups()

                    # On ignore les trois helm_chart suivant car installer en local et trop compliqué de faire le
                    # check comparatif des versions.
                    # Pour redisinsight la version installé le chart définit en local est différent du chart qui se
                    # trouve sur qube donc pour le moment on l'ignore également.
                    if name != "bernard" and name != "iconosquare-front" and name != "iconosquare-back" and name != "redisinsight":
                        helm_chart_data.append({
                            'name': name,
                            'version': version
                        })
        return helm_chart_data
    except Exception as e:
        print(f"Erreur lors de la récupération des versions installée : {e}")
        return None

######### Fonction dernière release disponible #########

def get_latest_version(repo_main, repo_name, service):
    try:
        match repo_main:
            case "artifact":
                # R&cupérer le flux rss du service traitée
                news_feed = feedparser.parse(f'https://artifacthub.io/api/v1/packages/helm/{repo_name}/{service}/feed/rss')

                # Récupérer la dernière version
                for i in range(0, len(news_feed.entries)):
                    if i == (len(news_feed.entries)-1):
                        title_tag = news_feed.entries[0]['title']

                        # Pour le cas de sonarqube on remplace le + par _
                        if title_tag:
                            version = title_tag.replace("+", "_")
                            return version
            case "github":
                # Récupérer l'url
                repo_url = f"https://github.com/{repo_name}/{service}/releases/latest"
                response = requests.get(repo_url)
                response.raise_for_status()
                html_content = response.text

                # Match
                version_match = re.search(r'/releases/tag/(v\d+(\.\d+)*)', html_content)
                if version_match:
                    latest_version = version_match.group(1)
                    return latest_version
                else:
                    return None
            case _ :
                result = "Erreur sur le repo principal"
                return result
    except Exception as e :
        print(f"Erreur lors de la récupération de la dernière version : {e}")
        return None

######### Fonction envoie d'event #########

# Fonction pour verifier si la dernière version d'un service existe si se n'est pas le cas alors envoie d'un event en
# un seul exemplaire.
def check_and_send_event(service, latest_version, helm_chart_data):
    # Vérifier si la dernière version existe dans le tableau
    latest_version_exists = any(entry.get('version') == latest_version for entry in helm_chart_data if entry.get('name') == service)

    # Vérifier si le service a déjà été traité
    if service not in processed_services and not latest_version_exists:
        # Aucune version correspondante, envoyer un seul événement
        send_version_event(latest_version, service)

        # Ajouter le service à la liste des services traités
        processed_services.append(service)

# Fonction pour faire l'envoie d'évent à datadog
def send_version_event(latest_version, name):

    # Création du contenu de l'event
    body = EventCreateRequest(
        title       = f'{name} : {latest_version} is latest version',
        text        = f'Latest Version: {latest_version}',
        alert_type  = "warning",
        tags        = [f'latest_version:{latest_version}'],
    )
    # Envoie de l'event à datadog
    with ApiClient(configuration) as api_client:
        api_instance    = EventsApi(api_client)
        response        = api_instance.create_event(body=body)

######### Appel des fonctions #########

# tableau pour les services traités
processed_services = []

def handler(event, context):
    try:
        if 'Records' in event:
            records = event['Records']

            for entry in records:
                repo_main = entry.get("repo_main")
                repo_name = entry.get("repo_name")
                service = entry.get("service")
                latest_version = get_latest_version(repo_main, repo_name, service)
                check_and_send_event(service, latest_version)

            return {
                'statusCode': 200,
                'body': 'Script exécuté sans erreurs !'
            }
        else:
            raise ValueError("La clé 'Records' est manquante dans l'événement.")

    except Exception as e:
        return {
            'statusCode': 500,
            'body': f'Erreur lors de l\'exécution du script : {str(e)}'
        }

),
        'appKeyAuth': APP_KEY
    }
)

######### Fonction pour version installée #########

# Fonction pour récupére la métric helm.release depuis datadog
def get_installed_version():
    try:
        with ApiClient(configuration) as api_client:
            api_instance = MetricsApi(api_client)

            response = api_instance.list_tags_by_metric_name(
                metric_name="helm.release",
            )
        # print(response)
        tags    = response['data']['attributes']['tags']

        # Récupérer que les tag "helm_chart"
        pattern = re.compile(r'^helm_chart:(.+?)-([a-zA-Z]*\d+\.\d+\.\d+(?:[._-]?\w*)?)$')

        # Block pour stocké dans un tableau le nom et la version
        helm_chart_data = []
        for tag in tags:
            if tag.startswith('helm_chart:'):
                match = pattern.match(tag)

                if match:
                    name, version = match.groups()

                    # On ignore les trois helm_chart suivant car installer en local et trop compliqué de faire le check
                    # comparatif des versions.
                    # Pour redisinsight la version installé le chart définit en local est différent du chart qui se
                    # trouve sur qube donc pour le moment on l'ignore également.
                    if name != "bernard" and name != "iconosquare-front" and name != "iconosquare-back" and name != "redisinsight":
                        helm_chart_data.append({
                            'name': name,
                            'version': version
                        })
        return helm_chart_data
    except Exception as e:
        print(f"Erreur lors de la récupération des versions installée : {e}")
        return None

######### Fonction dernière release disponible #########

def get_latest_version(repo_main, repo_name, service):
    try:
        match repo_main:
            case "artifact":
                # R&cupérer le flux rss du service traitée
                news_feed = feedparser.parse(f'https://artifacthub.io/api/v1/packages/helm/{repo_name}/{service}/feed/rss')

                # Récupérer la dernière version
                for i in range(0, len(news_feed.entries)):
                    if i == (len(news_feed.entries)-1):
                        title_tag = news_feed.entries[0]['title']

                        # Pour le cas de sonarqube on remplace le + par _
                        if title_tag:
                            version = title_tag.replace("+", "_")
                            return version
            case "github":
                # Récupérer l'url
                repo_url = f"https://github.com/{repo_name}/{service}/releases/latest"
                response = requests.get(repo_url)
                response.raise_for_status()
                html_content = response.text

                # Match
                version_match = re.search(r'/releases/tag/(v\d+(\.\d+)*)', html_content)
                if version_match:
                    latest_version = version_match.group(1)
                    return latest_version
                else:
                    return None
            case _ :
                result = "Erreur sur le repo principal"
                return result
    except Exception as e :
        print(f"Erreur lors de la récupération de la dernière version : {e}")
        return None

######### Fonction envoie d'event #########

# Fonction pour verifier si la dernière version d'un service existe si se n'est pas le cas alors envoie d'un event en
# un seul exemplaire.
def check_and_send_event(service, latest_version, helm_chart_data):
    # Vérifier si la dernière version existe dans le tableau
    latest_version_exists = any(entry.get('version') == latest_version for entry in helm_chart_data if entry.get('name') == service)

    # Vérifier si le service a déjà été traité
    if service not in processed_services and not latest_version_exists:
        # Aucune version correspondante, envoyer un seul événement
        send_version_event(latest_version, service)

        # Ajouter le service à la liste des services traités
        processed_services.append(service)

# Fonction pour faire l'envoie d'évent à datadog
def send_version_event(latest_version, name):

    # Création du contenu de l'event
    body = EventCreateRequest(
        title       = f'{name} : {latest_version} is latest version',
        text        = f'Latest Version: {latest_version}',
        alert_type  = "warning",
        tags        = [f'latest_version:{latest_version}'],
    )
    # Envoie de l'event à datadog
    with ApiClient(configuration) as api_client:
        api_instance    = EventsApi(api_client)
        response        = api_instance.create_event(body=body)

######### Appel des fonctions #########

# tableau pour les services traités
processed_services = []

def handler(event, context):
    try:
        if 'Records' in event:
            records = event['Records']

            for entry in records:
                repo_main = entry.get("repo_main")
                repo_name = entry.get("repo_name")
                service = entry.get("service")
                latest_version = get_latest_version(repo_main, repo_name, service)
                check_and_send_event(service, latest_version)

            return {
                'statusCode': 200,
                'body': 'Script exécuté sans erreurs !'
            }
        else:
            raise ValueError("La clé 'Records' est manquante dans l'événement.")

    except Exception as e:
        return {
            'statusCode': 500,
            'body': f'Erreur lors de l\'exécution du script : {str(e)}'
        }
                                </code></pre>
                                <img src="assets/img/screen-dahsboard-versioning.jpg" alt="Screen des alertes sur le dashboard datadog." class="screen">
                                <h4 class="title-ident2">Documentations réalisées : </h4>
                                <div>
                                    <div class="row certif">
                                        <div class="col-md-4 img-aws">
                                            <div class="flex-woaw">
                                                <div class="service-box certif-box test">
                                                    <div class="service-content">
                                                        <h2 class="s-title cve-title">Fog project </h2>
                                                        <img src="assets/img/fogproject-removebg.png" alt="">
                                                        <p>Guide utilisateur</p>
                                                    </div>
                                                </div>
                                                <div class="pdf">
                                                    <embed src="assets/DocFogProject.pdf" type="application/pdf"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="row certif">
                                        <div class="col-md-4 img-aws">
                                            <div class="flex-woaw">
                                                <div class="service-box certif-box test">
                                                    <div class="service-content">
                                                        <h2 class="s-title cve-title">Fog project </h2>
                                                        <img src="assets/img/fogproject-removebg.png" alt="">
                                                        <p>Création d'un user</p>
                                                    </div>
                                                </div>
                                                <div class="pdf">
                                                    <embed src="assets/crea_userufogproject.pdf" type="application/pdf"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>


<!-- Vendor JS Files -->
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/typed.js/typed.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/js/main.js"></script>
    <!-- Inclure Highlight.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <!-- Initialiser Highlight.js -->
    <script>hljs.highlightAll();</script>
